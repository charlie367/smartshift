<div class="notice-board">
  <div class="dialog-header">
    <button class="plain-close" (click)="close()" aria-label="é—œé–‰">
      <mat-icon>cancel</mat-icon>
    </button>
  </div>
<!-- 
  <div class="notice-header-bar">
    <h2 class="notice-title">ğŸ“¢ é€šçŸ¥ä½ˆå‘Šæ¬„</h2>
  </div> -->
  <div class="notice-header-bar">
  <h2 class="notice-title">
    <img src="/laba.png" alt="é€šçŸ¥åœ–ç¤º" class="notice-icon" />
    é€šçŸ¥ä½ˆå‘Šæ¬„
  </h2>
</div> 

  <div class="tabs">
    <button class="tab-btn" [class.active]="currentTab==='public'" (click)="switchTab('public')">
      å…¨é«”é€šçŸ¥
      @if (publicUnread()) {
        <span class="badge">{{ publicUnread() }}</span>
      }
    </button>

    <button class="tab-btn" [class.active]="currentTab==='personal'" (click)="switchTab('personal')">
      å€‹äººé€šçŸ¥
      @if (personalUnread()) {
        <span class="badge">{{ personalUnread() }}</span>
      }
    </button>
  </div>

  <div class="extra-line"></div>

  <div class="scroll-area">
    <!-- å…¬å‘Šåˆ†é  -->
    @if (currentTab === 'public') {
      @if (notifyList.length === 0) {
        <div class="empty-hint">ç›®å‰æ²’æœ‰å¯é¡¯ç¤ºçš„å…¬å‘Š</div>
      }

      @for (notify of notifyList; track notify.id) {
        <div
          class="notice-item"
          [class.read]="isRead(notify.id)"
          (click)="markAsRead(notify.id)"
        >
          <div class="notice-header">
            <!-- ç›´æ¥é¡¯ç¤ºå­—ä¸²ï¼Œé¿å… date ç®¡ç·šæ™‚å€åç§» -->
            <span class="notice-date">{{ notify.date }}</span>
            @if (notify.title) {
              <span class="notice-title-inline">{{ notify.title }}</span>
            }
          </div>

          <p class="notice-content">{{ notify.message }}</p>

          @if (notify.link) {
            <a
              [href]="normalizedLink(notify.link)"
              target="_blank"
              rel="noopener noreferrer"
            >
              {{ notify.link }}
            </a>
          }
        </div>
      }
    }

    <!-- å€‹äººé€šçŸ¥åˆ†é  -->
    @if (currentTab === 'personal') {
      @if (personalList.length === 0) {
        <div class="empty-hint">ç›®å‰æ²’æœ‰å€‹äººé€šçŸ¥</div>
      }

      @for (p of personalList; track p.id) {
        <div
          class="notice-item personal"
          [class.read]="isPersonalRead(p.id)"
          (click)="markPersonalAsRead(p.id)"
        >
          <div class="kv"><span class="k">é€šçŸ¥ä¸»æ—¨:</span><span class="v">{{ p.title || p.employeeId }}</span></div>
          <div class="kv"><span class="k">é€šçŸ¥å…§å®¹:</span><span class="v">{{ p.message }}</span></div>

          @if (p.link) {
            <div class="kv">
              <span class="k">ç¶²å€ï¼š</span>
              <span class="v">
                <a
                  [href]="normalizedLink(p.link)"
                  target="_blank"
                  rel="noopener noreferrer"
                >{{ p.link }}</a>
              </span>
            </div>
          }

          <div class="kv"><span class="k">é€šçŸ¥æ—¥æœŸï¼š</span><span class="v">{{ p.date }}</span></div>
        </div>
      }
    }
  </div>
</div>
