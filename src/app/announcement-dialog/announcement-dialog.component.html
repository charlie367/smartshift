<div class="notice-board">
  <div class="dialog-header">
    <button class="plain-close" (click)="close()" aria-label="é—œé–‰">
      <mat-icon>cancel</mat-icon>
    </button>
  </div>

  <div class="notice-header-bar">
    <h2 class="notice-title">ğŸ“¢ é€šçŸ¥ä½ˆå‘Šæ¬„</h2>
  </div>

  <!-- åˆ†é åˆ‡æ›ï¼ˆæ–°å¢ï¼‰ -->
  <!-- <div class="tabs">
    <button class="tab-btn" [class.active]="currentTab==='public'" (click)="switchTab('public')">å…¨é«”é€šçŸ¥</button>
    <button class="tab-btn" [class.active]="currentTab==='personal'" (click)="switchTab('personal')">å€‹äººé€šçŸ¥</button>
  </div> -->

  <div class="tabs">
    <button class="tab-btn" [class.active]="currentTab==='public'" (click)="switchTab('public')">
      å…¨é«”é€šçŸ¥
      <span class="badge" *ngIf="publicUnread">{{ publicUnread }}</span>
    </button>
  
    <button class="tab-btn" [class.active]="currentTab==='personal'" (click)="switchTab('personal')">
      å€‹äººé€šçŸ¥
      <span class="badge" *ngIf="personalUnread">{{ personalUnread }}</span>
    </button>
  </div>

  <div class="extra-line"></div>

  <!-- å…§å®¹æ²å‹•å€ï¼ˆæ–°å¢ï¼‰ -->
  <div class="scroll-area">

    <!-- å…¬å‘Šåˆ†é  -->
    <ng-container *ngIf="currentTab==='public'">
      <div *ngIf="notifyList.length === 0" class="empty-hint">
        ç›®å‰æ²’æœ‰å¯é¡¯ç¤ºçš„å…¬å‘Š
      </div>

      <div
        *ngFor="let notify of notifyList; trackBy: trackById"
        class="notice-item"
        [class.read]="isRead(notify.id)"
        (click)="markAsRead(notify.id)"
      >
        <div class="notice-header">
          <!-- ç›´æ¥é¡¯ç¤ºå­—ä¸²ï¼Œé¿å… date ç®¡ç·šæ™‚å€åç§» -->
          <span class="notice-date">{{ notify.date }}</span>
          <span class="notice-title-inline" *ngIf="notify.title">{{ notify.title }}</span>
        </div>

        <p class="notice-content">{{ notify.message }}</p>

        <a *ngIf="notify.link"
           [href]="normalizedLink(notify.link)"
           target="_blank" rel="noopener noreferrer">
          {{ notify.link }}
        </a>
      </div>
    </ng-container>

    <!-- å€‹äººé€šçŸ¥åˆ†é ï¼ˆæ–°å¢ï¼‰ -->
    <ng-container *ngIf="currentTab==='personal'">
      <div *ngIf="personalList.length === 0" class="empty-hint">ç›®å‰æ²’æœ‰å€‹äººé€šçŸ¥</div>

      <div
        *ngFor="let p of personalList; trackBy: trackById"
        class="notice-item personal"
        [class.read]="isPersonalRead(p.id)"
        (click)="markPersonalAsRead(p.id)"
      >
        <div class="kv"><span class="k">é€šçŸ¥ä¸»æ—¨:</span><span class="v">{{ p.title || p.employeeId }}</span></div>
        <div class="kv"><span class="k">é€šçŸ¥å…§å®¹:</span><span class="v">{{ p.message }}</span></div>
        <div class="kv" *ngIf="p.link">
          <span class="k">Link-urlï¼š</span>
          <span class="v"><a [href]="normalizedLink(p.link)" target="_blank" rel="noopener noreferrer">{{ p.link }}</a></span>
        </div>
        <div class="kv"><span class="k">é€šçŸ¥æ—¥æœŸï¼š</span><span class="v">{{ p.date }}</span></div>
      </div>
    </ng-container>

  </div>
</div>
